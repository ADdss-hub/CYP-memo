# 版本历史记录

> 自动生成于 2026/1/13 14:00:00

**总版本数：** 24

---

## 1.8.9

**发布时间：** 2026/1/13 14:00:00

**作者：** CYP

**上一版本：** 1.8.8

**变更类型：** 🐛 问题修复

### 变更内容

#### 🐛 问题修复

- 生产环境容器登录后备忘录不刷新：登录成功后使用 router.replace 并添加 refresh 时间戳参数强制刷新数据，同时优化 MemoListView 的 watch 监听逻辑，使用 immediate: true 和 nextTick 确保数据立即加载
- Windows 安装包界面英文问题：在 electron-builder NSIS 配置中添加 installerLanguages: ['SimpChinese'] 确保安装程序仅使用简体中文界面
- PDF导出长文字显示不完整：重写 exportToPDF 函数，移除 200 字符限制，实现分页导出（每页3条备忘录），支持长文本完整显示和自动换行
- Excel导出优先级显示英文：在 exportToExcel 函数中添加优先级中文映射（low->低, medium->中, high->高），确保导出的 Excel 文件中优先级显示为中文
- 导入导出格式保持一致：新增 stripHtmlTagsPreserveLineBreaks 和 textToHtml 函数，确保备忘录的回车换行和样式在导入导出时保持一模一样

#### ⚡ 性能优化

- PDF导出分页优化：每页显示3条备忘录，自动计算总页数，每页显示页码信息，内容过长时自动缩放适应页面
- 导入导出模板优化：JSON和Excel模板中添加多行文本示例，展示格式保持功能

---

## 1.8.6

**发布时间：** 2026/1/12 18:00:00

**作者：** CYP

**上一版本：** 1.8.5

**变更类型：** 🐛 问题修复

### 变更内容

#### 🐛 问题修复

- Windows 桌面端本地构建：修复 .npmrc 镜像配置，使用 npmmirror 替代华为云镜像解决 better-sqlite3 和 keytar 预构建二进制下载失败问题
- better-sqlite3 预构建二进制：修复华为云镜像返回损坏文件（incorrect header check）导致构建失败
- keytar 预构建二进制：添加 keytar_binary_host 配置指向 npmmirror，解决 GitHub 连接重置（ECONNRESET）导致下载失败
- electron-builder winCodeSign：手动预解压 winCodeSign-2.6.0.7z 到缓存目录，绕过 Windows 普通用户无法创建符号链接的权限限制
- 桌面端图标尺寸：构建前运行 create-placeholder-icons.mjs 生成 256x256 占位图标，修复 icon.ico must be at least 256x256 错误

#### ⚡ 性能优化

- pnpm 版本兼容性：放宽 engines 配置从固定版本改为 node>=20 和 pnpm>=8，支持更多开发环境
- 原生模块自动构建：添加 pnpm.onlyBuiltDependencies 配置，自动批准 better-sqlite3、keytar、electron、esbuild、sharp 的构建脚本执行
- npm 镜像源统一：使用 npmmirror（淘宝源）作为 npm、Electron、原生模块的镜像源，提升国内网络环境下载速度和稳定性

---

## 1.8.0

**发布时间：** 2026/1/11 22:00:00

**作者：** CYP

**上一版本：** 1.7.11

**变更类型：** ✨ 功能更新

### 变更内容

#### ✨ 新增功能

- 桌面端核心功能完成：窗口管理、系统托盘、全局快捷键、本地缓存、离线同步、通知系统、自动更新
- 桌面端安全增强：凭证管理器使用系统安全存储、AES-256 本地数据加密、HTTPS 强制、CSP 内容安全策略
- 桌面端跨平台支持：Windows/macOS/Linux 平台特定功能、统一拖放处理、跨平台路径处理
- 桌面端服务器连接：支持远程服务器和内置服务器两种模式、首次启动配置向导
- 桌面端构建配置：electron-builder 多平台打包、代码签名配置、GitHub Releases 自动发布

#### 📝 文档

- 桌面端文档完善：BUILD.md 构建指南、README.md 功能说明、设计文档和任务列表更新

---

## 1.7.11

**发布时间：** 2026/1/11 20:00:00

**作者：** CYP

**上一版本：** 1.7.10

**变更类型：** 🐛 问题修复

### 变更内容

#### ✨ 新增功能

- 全端版本更新检测：所有端（桌面端、Web用户端、Web管理端、Docker）都支持自动检测新版本并提示更新
- 桌面端自动更新：集成 electron-updater，启动时检查 GitHub Releases，后台下载更新并提示安装
- Web 端更新提示：每 5 分钟检测服务器版本，发现新版本在页面顶部显示提示条
- Docker 更新支持：自动检测 Docker 环境，显示 Watchtower 自动更新和手动更新两种方式
- 多镜像源支持：Docker 更新命令支持 Docker Hub 和 GHCR 两个镜像源
- 一键发布脚本：整合版本更新工具和 Git 操作，支持 patch/minor/major 版本发布
- GitHub Actions 自动发布：创建 tag 后自动构建所有端并发布到 GitHub Releases
- 服务器版本 API：新增 /api/version/latest 端点，从 GitHub Releases 获取最新版本信息

#### 📝 文档

- 发布指南文档：新增 docs/RELEASE.md，详细说明发布流程和各端更新方式

---

## 1.7.10

**发布时间：** 2026/1/11 16:00:00

**作者：** CYP

**上一版本：** 1.7.9

**变更类型：** 🐛 问题修复

### 变更内容

#### 🐛 问题修复

- Docker 容器数据目录权限问题：修复在飞牛 NAS 等设备上使用绑定挂载时出现 EACCES permission denied 错误

#### ✨ 新增功能

- Docker 入口脚本：新增 entrypoint.sh 处理数据目录权限，支持 PUID/PGID 环境变量配置运行用户
- 多 NAS 系统支持：支持飞牛 NAS、群晖、威联通、铁威马、Unraid 等多种 NAS 系统的 Docker 部署

#### ⚡ 性能

- 错误提示优化：数据目录权限错误时提供详细的解决方案和各 NAS 系统的配置示例
- Docker 镜像优化：安装 su-exec 工具支持运行时权限切换，数据目录默认设置宽松权限

#### 📝 文档

- Docker 文档更新：添加各 NAS 系统的部署指南和权限问题排查方法

---

## 1.7.9

**发布时间：** 2026/1/10 23:49:46

**作者：** CYP

**上一版本：** 1.7.8

**变更类型：** 🐛 问题修复

### 变更内容

#### 🐛 问题修复

- 创建子账号错误提示优化：输入主账号用户名时显示友好提示，而非API请求失败400错误
- 系统日志按级别筛选：修复管理端系统监控中按级别筛选日志不工作的问题，新增getLogsByLevel方法和API端点

#### ✨ 新增功能

- 主账号和子账号备忘录共享：主账号可以看到所有子账号创建的备忘录，子账号也可以看到主账号的备忘录
- 备忘录显示创建人信息：备忘录列表中显示创建人用户名和创建日期，方便区分不同账号的备忘录

#### ⚡ 性能

- 界面版权信息中文化：删除所有界面版权信息中的英文内容，统一使用中文显示
- 备忘录数据隔离：子账号可以看到同一主账号下其他子账号的备忘录，不同主账号之间的数据完全隔离互不可见

---

## 1.7.8

**发布时间：** 2026/1/10 23:24:44

**作者：** CYP

**上一版本：** 1.7.8

**变更类型：** 🔧 日常维护

### 变更内容

- 无详细变更记录

---

## 1.7.7

**发布时间：** 2026/1/10 23:01:25

**作者：** CYP

**上一版本：** 1.7.6

**变更类型：** 🐛 问题修复

### 变更内容

- 无详细变更记录

---

## 1.7.6

**发布时间：** 2026/1/10 22:41:45

**作者：** CYP

**上一版本：** 1.7.5

**变更类型：** 🐛 问题修复

### 变更内容

- 无详细变更记录

---

## 1.7.5

**发布时间：** 2026/1/10 22:36:25

**作者：** CYP

**上一版本：** 1.7.4

**变更类型：** 🐛 问题修复

### 变更内容

- 无详细变更记录

---

## 1.7.4

**发布时间：** 2026/1/10 22:25:55

**作者：** CYP

**上一版本：** 1.7.3

**变更类型：** 🐛 问题修复

### 变更内容

- 无详细变更记录

---

## 1.7.3

**发布时间：** 2026/1/10 21:56:50

**作者：** CYP

**上一版本：** 1.7.2

**变更类型：** 🐛 问题修复

### 变更内容

#### ✨ 新增功能

- 版权信息分行展示：所有界面的版权信息改为分行展示版和中英融合版，新增copyrightLines getter

#### 🐛 问题修复

- 管理端用户删除功能：修复用户管理中删除普通用户的功能，服务器端自动删除用户及其所有关联数据
- 数据库清理功能：修复管理端数据库清理功能在远程模式下不工作的问题，新增服务器端清理API

#### ⚡ 性能

- 远程存储适配器：扩展RemoteStorageAdapter支持cleanDeletedMemos、cleanOrphanedFiles、performCleanup方法

---

## 1.7.2

**发布时间：** 2026/1/10 21:35:12

**作者：** CYP

**上一版本：** 1.7.1

**变更类型：** 🐛 问题修复

### 变更内容

- 无详细变更记录

---

## 1.7.1

**发布时间：** 2026/1/10 21:20:35

**作者：** CYP

**上一版本：** 1.7.0

**变更类型：** 🐛 问题修复

### 变更内容

- 无详细变更记录

---

## 1.6.2

**发布时间：** 2026/1/10 20:27:19

**作者：** CYP

**上一版本：** 1.6.1

**变更类型：** 🐛 问题修复

### 变更内容

#### 🐛 问题修复

- 管理员登录失败：修复远程模式下管理员登录时密码验证失败的问题，服务器端不返回passwordHash导致前端无法验证
- 服务器端API缺失：添加日志相关的API端点 (POST/GET/DELETE /api/logs)，修复日志记录失败的问题
- 清空数据API路径错误：修正RemoteStorageAdapter中clearAllData方法的API路径从/data改为/data/clear

#### ✨ 新增功能

- 管理员登录方法：在IStorageAdapter接口中新增adminLogin方法，支持本地和远程两种登录模式

#### ⚡ 性能

- 启动脚本优化：dev.bat自动启动服务器端，无需手动启动多个进程
- 自动打开浏览器：关闭Vite开发服务器的自动打开浏览器功能，避免启动时打开多个标签页
- 清空数据库确认文本：将确认文本从英文"CLEAR"改为中文"确认"，提升用户体验

---

## 1.6.1

**发布时间：** 2026/1/10 19:49:44

**作者：** CYP

**上一版本：** 1.6.0

**变更类型：** 🐛 问题修复

### 变更内容

#### 🐛 问题修复

- 子账号列表 API：在服务器端实现 getSubAccounts 方法，修复用户端账号管理界面加载子账号列表失败的问题
- 主题设置全局生效：将所有组件和视图的深色主题样式从 @media (prefers-color-scheme: dark) 改为 [data-theme='dark']
- 管理端用户列表刷新：添加刷新按钮和 onActivated 生命周期钩子，清除数据库后能正确刷新用户列表
- PDF 导出中文格式：修复备忘录数据管理界面 PDF 导出功能的英文文本

#### ⚡ 性能

- 主题样式统一：修复了用户端和管理端所有组件和视图的主题支持

---

## 1.6.0

**发布时间：** 2026/1/10 19:26:42

**作者：** CYP

**上一版本：** 1.5.1

**变更类型：** ✨ 功能更新

### 变更内容

#### ✨ 新增功能

- 后端 API 服务器：新增独立的后端服务 (packages/server)，支持 App 和 Admin 共享数据
- JSON 文件存储：后端使用 JSON 文件存储数据，适用于本地和 NAS/容器环境
- 管理员系统：独立的管理员账号体系，与用户账号完全分离
- 默认管理员：系统启动时自动创建默认管理员 (admin/admin123)
- 存储适配器架构：支持本地存储 (IndexedDB) 和远程存储 (REST API) 两种模式
- RemoteStorageAdapter：通过 REST API 与后端通信的存储适配器
- 数据导入导出 API：支持从旧数据迁移到新后端

#### ⚡ 性能

- UserDAO 重构：使用存储管理器，支持本地和远程存储切换
- App 和 Admin 配置：两端都配置为连接后端 API (端口 5170)

#### 🐛 问题修复

- 跨端口数据隔离问题：通过共享后端 API 解决 IndexedDB 按域名隔离的问题

---

## 1.4.7

**发布时间：** 2026/1/10 17:22:27

**作者：** CYP

**上一版本：** 1.4.6

**变更类型：** 🐛 问题修复

### 变更内容

#### ✨ 新增功能

- 账号密码注册时自动生成个人令牌：用户注册时系统自动为其生成唯一的个人令牌
- 令牌显示在注册成功页面：注册完成后立即显示自动生成的令牌，用户可复制保存
- 令牌全局应用：自动生成的令牌可用于登录系统，与令牌注册用户享受同等权限

#### ⚡ 性能

- 注册流程：账号密码注册和令牌注册现在都能获得个人令牌，提升用户体验
- 令牌管理：所有用户（无论注册方式）都拥有个人令牌，便于全局管理和引用
- 注册成功提示：显示自动生成的令牌，提醒用户保存以备后用

---

## 1.4.6

**发布时间：** 2026/1/10 17:10:29

**作者：** CYP

**上一版本：** 1.4.5

**变更类型：** 🐛 问题修复

### 变更内容

#### 🐛 问题修复

- 表单字段缺少id属性：为所有el-input元素添加唯一的id属性
- 表单标签关联问题：确保label的for属性与表单字段的id匹配
- 浏览器自动填充问题：添加id属性使浏览器能正确识别表单字段
- 无障碍访问问题：改进屏幕阅读器对表单的识别

#### ⚡ 性能

- AccountsView表单：为创建子账号表单的所有输入字段添加id
- ProfileView表单：为个人资料编辑表单的所有输入字段添加id
- ProfileView安全问题表单：为安全问题答案输入字段添加id
- ProfileView密码修改表单：为密码修改表单的所有输入字段添加id

---

## 1.4.5

**发布时间：** 2026/1/10 16:50:00

**作者：** CYP

**上一版本：** 1.4.4

**变更类型：** 🐛 问题修复

### 变更内容

#### 🐛 问题修复

- 创建子账号不能创建的问题：bcryptjs在浏览器中尝试使用Node.js crypto模块导致失败
- 密码哈希函数浏览器兼容性：实现浏览器环境中的PBKDF2密码哈希替代方案
- 密码验证函数浏览器兼容性：实现浏览器环境中的PBKDF2密码验证替代方案
- 表单验证错误：confirmPassword验证器未正确处理空值情况
- Vite配置：添加ssr.noExternal配置确保bcryptjs在浏览器中正确处理

#### ⚡ 性能

- 密码哈希实现：自动检测运行环境，浏览器中使用Web Crypto API，Node.js中使用bcryptjs
- 密码验证实现：支持两种环境的密码验证，确保兼容性
- 表单验证规则：改进confirmPassword验证器的错误处理逻辑

---

## 1.4.4

**发布时间：** 2026/1/10 16:30:00

**作者：** CYP

**上一版本：** 1.4.3

**变更类型：** 🐛 问题修复

### 变更内容

#### 🐛 问题修复

- 导入导出文件编码问题：JSON导出使用UTF-8编码，Excel导入改用ArrayBuffer处理，PDF导出文件名改为英文避免乱码
- ShareManageView 加载分享链接失败：修复 authStore.user?.id 应为 authStore.currentUser?.id 的错误
- AccountsView 缺少 UserIf 组件注册：修复模板中使用 <User /> 而未正确导入的问题，改为 <UserIcon />
- Element Plus checkbox 弃用警告：将所有 el-checkbox 的 :label 属性改为 :value 属性，适配 Element Plus 3.0
- crypto 模块浏览器兼容性问题：创建 generateUUID() 函数替代 crypto.randomUUID()，支持所有浏览器环境

#### ⚡ 性能

- 文件导入导出流程：JSON 导出使用 TextEncoder 确保 UTF-8 编码，Excel 导入使用 ArrayBuffer 提高兼容性
- UUID 生成函数：添加 fallback 机制，优先使用 crypto.randomUUID()，不可用时手动生成 UUID v4
- 所有 crypto.randomUUID() 调用：统一使用 generateUUID() 函数，提高代码可维护性

---

## 1.3.0

**发布时间：** 2026/1/10 15:54:08

**作者：** CYP

**上一版本：** 1.3.0

**变更类型：** 🔧 日常维护

### 变更内容

- 无详细变更记录

---

## 1.2.0

**发布时间：** 2026/1/10 15:39:03

**作者：** CYP

**上一版本：** 1.1.1

**变更类型：** ✨ 功能更新

### 变更内容

- 无详细变更记录

---

## 1.1.0

**发布时间：** 2026/1/10 15:07:48

**作者：** CYP

**上一版本：** 1.0.2

**变更类型：** ✨ 功能更新

### 变更内容

- 无详细变更记录

---

## 统计信息

- **总版本数：** 22
- **主版本更新：** 0 次
- **次版本更新：** 4 次
- **补丁更新：** 16 次
- **首个版本：** 1.1.0
- **最新版本：** 1.8.0
- **首次发布：** 2026/1/10 15:07:48
- **最后更新：** 2026/1/11 22:00:00
