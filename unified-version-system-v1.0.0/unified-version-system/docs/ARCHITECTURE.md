# ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿæ¶æ„

## è®¾è®¡ç†å¿µ

åŸºäº**å•ä¸€èŒè´£åŸåˆ™**å’Œ**æ¨¡å—åŒ–è®¾è®¡**ï¼Œå°†ç‰ˆæœ¬ç®¡ç†åŠŸèƒ½æ‹†åˆ†ä¸ºç‹¬ç«‹çš„åŠŸèƒ½æ¨¡å—ï¼Œé€šè¿‡ç»Ÿä¸€çš„ç®¡ç†å™¨è¿›è¡Œåè°ƒã€‚

## æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           UnifiedVersionManager (ç»Ÿä¸€ç®¡ç†å™¨)              â”‚
â”‚                                                           â”‚
â”‚  - åè°ƒæ‰€æœ‰æ¨¡å—                                            â”‚
â”‚  - æä¾›ç»Ÿä¸€æ¥å£                                            â”‚
â”‚  - è‡ªåŠ¨åŒ–å·¥ä½œæµ                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚          â”‚
        â–¼                   â–¼                   â–¼          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚VersionValidatorâ”‚    â”‚VersionWriter â”‚    â”‚VersionIncrementerâ”‚ â”‚VersionHistoryâ”‚
â”‚  (éªŒè¯æ¨¡å—)    â”‚    â”‚  (å†™å…¥æ¨¡å—)  â”‚    â”‚  (é€’å¢æ¨¡å—)  â”‚ â”‚  (å†å²æ¨¡å—)  â”‚
â”‚                â”‚    â”‚              â”‚    â”‚              â”‚ â”‚              â”‚
â”‚ - æ ¼å¼éªŒè¯     â”‚    â”‚ - VERSION    â”‚    â”‚ - è§£æç‰ˆæœ¬   â”‚ â”‚ - è®°å½•å†å²   â”‚
â”‚ - ç¡¬ç¼–ç æ£€æŸ¥   â”‚    â”‚ - package.jsonâ”‚   â”‚ - é€’å¢è®¡ç®—   â”‚ â”‚ - ç”Ÿæˆæ–‡æ¡£   â”‚
â”‚ - ç”ŸæˆæŠ¥å‘Š     â”‚    â”‚ - å‰ç«¯ç‰ˆæœ¬   â”‚    â”‚ - ç‰ˆæœ¬æ¯”è¾ƒ   â”‚ â”‚ - ç»Ÿè®¡åˆ†æ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ¨¡å—è¯´æ˜

### 1. VersionValidator (éªŒè¯æ¨¡å—)

**èŒè´£ï¼š** éªŒè¯ç‰ˆæœ¬å·çš„æ­£ç¡®æ€§

**åŠŸèƒ½ï¼š**
- éªŒè¯ç‰ˆæœ¬å·æ ¼å¼ (x.y.z)
- æ£€æŸ¥ç¡¬ç¼–ç é—®é¢˜
- ç”ŸæˆéªŒè¯æŠ¥å‘Š

**æ¥å£ï¼š**
```javascript
const validator = new VersionValidator(options);

// éªŒè¯æ ¼å¼
validator.validateFormat(version);

// æ£€æŸ¥ç¡¬ç¼–ç 
validator.checkHardcode();

// å®Œæ•´éªŒè¯
validator.validate(version);

// ç”ŸæˆæŠ¥å‘Š
validator.generateReport(results);
```

**ç‹¬ç«‹ä½¿ç”¨ï¼š**
```bash
node unified-version-system/modules/version-validator.js 1.15.7
```

### 2. VersionWriter (å†™å…¥æ¨¡å—)

**èŒè´£ï¼š** å°†ç‰ˆæœ¬å·å†™å…¥å„ä¸ªæ–‡ä»¶

**åŠŸèƒ½ï¼š**
- å†™å…¥ VERSION æ–‡ä»¶
- æ›´æ–° package.json æ–‡ä»¶
- ç”Ÿæˆå‰ç«¯ç‰ˆæœ¬æ–‡ä»¶

**æ¥å£ï¼š**
```javascript
const writer = new VersionWriter(options);

// å†™å…¥ VERSION æ–‡ä»¶
writer.writeVersionFile(version);

// å†™å…¥ package.json
writer.writePackageJson(version);

// å†™å…¥å‰ç«¯ç‰ˆæœ¬
writer.writeFrontendVersion(version);

// å†™å…¥æ‰€æœ‰æ–‡ä»¶
writer.writeAll(version);
```

**ç‹¬ç«‹ä½¿ç”¨ï¼š**
```bash
node unified-version-system/modules/version-writer.js 1.15.7
```

### 3. VersionIncrementer (é€’å¢æ¨¡å—)

**èŒè´£ï¼š** è®¡ç®—ç‰ˆæœ¬å·é€’å¢

**åŠŸèƒ½ï¼š**
- è§£æç‰ˆæœ¬å·
- é€’å¢ä¸»/æ¬¡/è¡¥ä¸ç‰ˆæœ¬
- ç‰ˆæœ¬å·æ¯”è¾ƒ
- æä¾›ç‰ˆæœ¬å»ºè®®

**æ¥å£ï¼š**
```javascript
const incrementer = new VersionIncrementer(options);

// é€’å¢ä¸»ç‰ˆæœ¬
incrementer.incrementMajor(version);

// é€’å¢æ¬¡ç‰ˆæœ¬
incrementer.incrementMinor(version);

// é€’å¢è¡¥ä¸ç‰ˆæœ¬
incrementer.incrementPatch(version);

// é€šç”¨é€’å¢
incrementer.increment(version, type);

// ç‰ˆæœ¬æ¯”è¾ƒ
incrementer.compare(v1, v2);

// è·å–å»ºè®®
incrementer.getSuggestions(currentVersion);
```

**ç‹¬ç«‹ä½¿ç”¨ï¼š**
```bash
node unified-version-system/modules/version-incrementer.js 1.15.7 patch
```

### 4. VersionHistory (å†å²æ¨¡å—)

**èŒè´£ï¼š** ç®¡ç†å’Œç”Ÿæˆç‰ˆæœ¬å†å²è®°å½•

**åŠŸèƒ½ï¼š**
- è®°å½•ç‰ˆæœ¬å˜æ›´å†å²
- ç”Ÿæˆ Markdown æ ¼å¼æ–‡æ¡£
- æ¸…ç†é‡å¤è®°å½•
- ç»Ÿè®¡ç‰ˆæœ¬ä¿¡æ¯

**æ¥å£ï¼š**
```javascript
const history = new VersionHistory(options);

// è¯»å–å†å²è®°å½•
history.readHistory();

// æ·»åŠ å†å²è®°å½•
history.addRecord({
  version: '1.15.8',
  author: 'CYP',
  changes: [
    { type: 'feat', description: 'æ–°å¢åŠŸèƒ½' }
  ],
  type: 'patch',
  previousVersion: '1.15.7'
});

// ç”Ÿæˆ Markdown æ–‡æ¡£
history.saveMarkdown();

// æ¸…ç†é‡å¤è®°å½•
history.cleanDuplicates();

// è·å–ç»Ÿè®¡ä¿¡æ¯
history.getStats();
```

**ç‹¬ç«‹ä½¿ç”¨ï¼š**
```bash
node unified-version-system/modules/version-history.js generate
node unified-version-system/modules/version-history.js clean
node unified-version-system/modules/version-history.js stats
```

### 5. UnifiedVersionManager (ç»Ÿä¸€ç®¡ç†å™¨)

**èŒè´£ï¼š** åè°ƒæ‰€æœ‰æ¨¡å—ï¼Œæä¾›ç»Ÿä¸€æ¥å£

**åŠŸèƒ½ï¼š**
- å®Œæ•´çš„ç‰ˆæœ¬æ›´æ–°æµç¨‹
- è‡ªåŠ¨åŒ–å·¥ä½œæµ
- é”™è¯¯å¤„ç†å’Œå›æ»š
- çŠ¶æ€æŠ¥å‘Š

**æ¥å£ï¼š**
```javascript
const manager = new UnifiedVersionManager(options);

// æ›´æ–°ç‰ˆæœ¬ï¼ˆå®Œæ•´æµç¨‹ï¼‰
await manager.updateVersion(newVersion, options);

// é€’å¢ç‰ˆæœ¬ï¼ˆå®Œæ•´æµç¨‹ï¼‰
await manager.incrementVersion(type, options);

// è·å–ç‰ˆæœ¬ä¿¡æ¯
manager.getVersionInfo();

// éªŒè¯ç³»ç»Ÿ
manager.validateSystem();
```

**ä½¿ç”¨ï¼š**
```bash
# æ›´æ–°åˆ°æŒ‡å®šç‰ˆæœ¬
node unified-version-system/version-manager-unified.js update 1.16.0

# é€’å¢ç‰ˆæœ¬
node unified-version-system/version-manager-unified.js increment patch

# æŸ¥çœ‹ä¿¡æ¯
node unified-version-system/version-manager-unified.js info

# éªŒè¯ç³»ç»Ÿ
node unified-version-system/version-manager-unified.js validate
```

## å·¥ä½œæµç¨‹

### å®Œæ•´çš„ç‰ˆæœ¬æ›´æ–°æµç¨‹

```
1. éªŒè¯ç‰ˆæœ¬å·
   â”œâ”€ æ ¼å¼éªŒè¯
   â””â”€ ç¡¬ç¼–ç æ£€æŸ¥
   
2. æ£€æŸ¥ç‰ˆæœ¬å†²çª
   â””â”€ ä¸å½“å‰ç‰ˆæœ¬æ¯”è¾ƒ
   
3. å†™å…¥ç‰ˆæœ¬å·
   â”œâ”€ VERSION æ–‡ä»¶
   â”œâ”€ package.json æ–‡ä»¶
   â””â”€ å‰ç«¯ç‰ˆæœ¬æ–‡ä»¶
   
4. éªŒè¯å†™å…¥ç»“æœ
   â””â”€ å†æ¬¡æ£€æŸ¥ç¡¬ç¼–ç 
   
5. æ›´æ–°ç‰ˆæœ¬å†å²è®°å½•
   â”œâ”€ æ·»åŠ å†å²è®°å½•åˆ° JSON
   â”œâ”€ ç”Ÿæˆ Markdown æ–‡æ¡£
   â””â”€ æ™ºèƒ½åˆ¤æ–­ç‰ˆæœ¬ç±»å‹
```

### è‡ªåŠ¨åŒ–ç‰¹æ€§

- **æ­¥éª¤ 1 å¤±è´¥** â†’ ç»ˆæ­¢æµç¨‹ï¼Œä¸è¿›è¡Œä»»ä½•å†™å…¥
- **æ­¥éª¤ 2 è­¦å‘Š** â†’ ç»§ç»­æ‰§è¡Œï¼Œä½†ç»™å‡ºæç¤º
- **æ­¥éª¤ 3 å¤±è´¥** â†’ å°è¯•å›æ»šå·²å†™å…¥çš„æ–‡ä»¶
- **æ­¥éª¤ 4 å¤±è´¥** â†’ æŠ¥å‘Šé”™è¯¯ï¼Œå»ºè®®æ‰‹åŠ¨æ£€æŸ¥
- **æ­¥éª¤ 5 å¯é€‰** â†’ å¯é€šè¿‡é€‰é¡¹è·³è¿‡

## NPM è„šæœ¬é›†æˆ

```json
{
  "scripts": {
    "version:update": "æ›´æ–°åˆ°æŒ‡å®šç‰ˆæœ¬",
    "version:patch": "é€’å¢è¡¥ä¸ç‰ˆæœ¬",
    "version:minor": "é€’å¢æ¬¡ç‰ˆæœ¬",
    "version:major": "é€’å¢ä¸»ç‰ˆæœ¬",
    "version:info": "æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯",
    "version:validate": "éªŒè¯ç‰ˆæœ¬ç³»ç»Ÿ",
    "version:check-hardcode": "æ£€æŸ¥ç¡¬ç¼–ç ",
    "version:history": "ç”Ÿæˆç‰ˆæœ¬å†å²æ–‡æ¡£",
    "version:history-clean": "æ¸…ç†é‡å¤è®°å½•",
    "version:history-stats": "æ˜¾ç¤ºç‰ˆæœ¬ç»Ÿè®¡"
  }
}
```

## ä½¿ç”¨ç¤ºä¾‹

### 1. é€’å¢è¡¥ä¸ç‰ˆæœ¬

```bash
npm run version:patch
```

**æ‰§è¡Œæµç¨‹ï¼š**
1. è¯»å–å½“å‰ç‰ˆæœ¬ (1.15.7)
2. è®¡ç®—æ–°ç‰ˆæœ¬ (1.15.8)
3. éªŒè¯æ–°ç‰ˆæœ¬æ ¼å¼
4. æ£€æŸ¥ç¡¬ç¼–ç 
5. å†™å…¥æ‰€æœ‰æ–‡ä»¶
6. éªŒè¯å†™å…¥ç»“æœ
7. æ›´æ–°ç‰ˆæœ¬å†å²è®°å½•

### 2. æ›´æ–°åˆ°æŒ‡å®šç‰ˆæœ¬

```bash
npm run version:update 2.0.0
```

**æ‰§è¡Œæµç¨‹ï¼š**
åŒä¸Šï¼Œä½†è·³è¿‡æ­¥éª¤ 2ï¼ˆç›´æ¥ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬ï¼‰

### 3. æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯

```bash
npm run version:info
```

**è¾“å‡ºï¼š**
```
ğŸ“Š ç‰ˆæœ¬ä¿¡æ¯:

å½“å‰ç‰ˆæœ¬: 1.15.7

ç‰ˆæœ¬å»ºè®®:
  Patch: 1.15.8
  Minor: 1.16.0
  Major: 2.0.0
```

### 4. éªŒè¯ç‰ˆæœ¬ç³»ç»Ÿ

```bash
npm run version:validate
```

**æ£€æŸ¥é¡¹ï¼š**
- ç‰ˆæœ¬å·æ ¼å¼
- ç¡¬ç¼–ç é—®é¢˜
- æ–‡ä»¶ä¸€è‡´æ€§

## æ‰©å±•æ€§

### æ·»åŠ æ–°çš„éªŒè¯è§„åˆ™

åœ¨ `VersionValidator` ä¸­æ·»åŠ æ–°æ–¹æ³•ï¼š

```javascript
validateCustomRule(version) {
  // è‡ªå®šä¹‰éªŒè¯é€»è¾‘
}
```

### æ·»åŠ æ–°çš„å†™å…¥ç›®æ ‡

åœ¨ `VersionWriter` ä¸­æ·»åŠ æ–°æ–¹æ³•ï¼š

```javascript
writeCustomFile(version) {
  // å†™å…¥è‡ªå®šä¹‰æ–‡ä»¶
}
```

### æ·»åŠ æ–°çš„å·¥ä½œæµæ­¥éª¤

åœ¨ `UnifiedVersionManager` ä¸­çš„ `updateVersion` æ–¹æ³•ä¸­æ·»åŠ ï¼š

```javascript
// æ­¥éª¤ 6: è‡ªå®šä¹‰æ­¥éª¤
if (!this.silent) {
  console.log('ğŸ“‹ æ­¥éª¤ 6/6: è‡ªå®šä¹‰æ“ä½œ');
}
await this.customOperation(newVersion);
```

## ä¼˜åŠ¿

1. **æ¨¡å—åŒ–è®¾è®¡** - æ¯ä¸ªæ¨¡å—èŒè´£å•ä¸€ï¼Œæ˜“äºç»´æŠ¤
2. **ç»Ÿä¸€æ¥å£** - é€šè¿‡ç®¡ç†å™¨æä¾›ä¸€è‡´çš„ä½¿ç”¨ä½“éªŒ
3. **è‡ªåŠ¨åŒ–æµç¨‹** - ä¸€ä¸ªå‘½ä»¤å®Œæˆæ‰€æœ‰æ“ä½œ
4. **é”™è¯¯å¤„ç†** - å®Œå–„çš„é”™è¯¯æ£€æµ‹å’Œæç¤º
5. **å¯æ‰©å±•æ€§** - æ˜“äºæ·»åŠ æ–°åŠŸèƒ½
6. **ç‹¬ç«‹ä½¿ç”¨** - æ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥ç‹¬ç«‹è¿è¡Œ
7. **ç±»å‹å®‰å…¨** - æ¸…æ™°çš„æ¥å£å®šä¹‰
8. **æµ‹è¯•å‹å¥½** - æ¨¡å—åŒ–ä¾¿äºå•å…ƒæµ‹è¯•

## æ–‡ä»¶ç»“æ„

```
unified-version-system/
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ version-validator.js      # éªŒè¯æ¨¡å—
â”‚   â”œâ”€â”€ version-writer.js          # å†™å…¥æ¨¡å—
â”‚   â”œâ”€â”€ version-incrementer.js     # é€’å¢æ¨¡å—
â”‚   â””â”€â”€ version-history.js         # å†å²æ¨¡å—
â”œâ”€â”€ version-manager-unified.js     # ç»Ÿä¸€ç®¡ç†å™¨
â””â”€â”€ ARCHITECTURE.md                # æœ¬æ–‡æ¡£
```

## è¿ç§»æŒ‡å—

### ä»æ—§ç³»ç»Ÿè¿ç§»

1. å®‰è£…æ–°ç³»ç»Ÿï¼ˆå·²å®Œæˆï¼‰
2. æ›´æ–° package.json è„šæœ¬ï¼ˆå·²å®Œæˆï¼‰
3. æµ‹è¯•æ–°å‘½ä»¤ï¼š
   ```bash
   npm run version:info
   npm run version:validate
   ```
4. é€æ­¥æ›¿æ¢æ—§è„šæœ¬çš„ä½¿ç”¨

### å…¼å®¹æ€§

æ–°ç³»ç»Ÿå®Œå…¨å…¼å®¹æ—§çš„æ–‡ä»¶æ ¼å¼ï¼š
- VERSION æ–‡ä»¶
- package.json
- frontend/src/utils/version.ts

## æ€»ç»“

ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿé€šè¿‡æ¨¡å—åŒ–è®¾è®¡å’Œè‡ªåŠ¨åŒ–å·¥ä½œæµï¼Œæä¾›äº†ä¸€ä¸ªå¼ºå¤§ã€çµæ´»ã€æ˜“äºç»´æŠ¤çš„ç‰ˆæœ¬ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚æ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥ç‹¬ç«‹ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç»Ÿä¸€ç®¡ç†å™¨åè°ƒå·¥ä½œï¼Œå®ç°äº†é«˜å†…èšã€ä½è€¦åˆçš„è®¾è®¡ç›®æ ‡ã€‚
